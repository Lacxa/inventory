#:import sm kivy.uix.screenmanager

#pos_hint:{'center_x':.9, 'center_y':.95}
ScreenManager
    id:manager
    transition:sm.FadeTransition(duration=.0)


    MDScreen:
        name:'home'
        FloatLayout:
            orientation:'vertical'
            MDIconButton:
                icon:"segment"
                pos_hint:{"center_x":.9,"center_y":.95}
                user_font_size:"35"
                on_release:
                    app.screen_capture("info")
            #MDToolbar:
             #   specific_text_color:78/255, 82/255, 84/255, 1
              #  md_bg_color:1, 1, 1, 1
               # right_action_items: [["segment", lambda x:  app.screen_capture('info')]]
                #pos_hint:{'center_y':.95}

            Front:
                pos_hint:{'center_x':.5, 'center_y':.7}
                MDIconButton:
                    icon:"plus"
                    user_font_size:"100sp"
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
                    on_release:
                        app.screen_capture("add")

            MDLabel:
                halign:"center"
                text:"Add Medicine"
                pos_hint:{'center_x':.5, 'center_y':.58}
            Front:
                pos_hint:{'center_x':.5, 'center_y':.4}
                MDIconButton:
                    icon:"barcode-scan"
                    user_font_size:"100sp"
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
                    on_release:
                        app.screen_capture("sell")

            MDLabel:
                halign:"center"
                text:"Sell Medicine"
                pos_hint:{'center_x':.5, 'center_y':.28}

    MDScreen:
        name:"share"
        FloatLayout:
            MDTextField:
                id:username
                mode: "rectangle"
                #fill_color: 0, 0, 0, .4
                size_hint: .6, .1
                pos_hint:{'center_x':.5, 'center_y':.8}
                hint_text:"Share, phone number"
                #text_color: 1, 1, 1, 1
                font_size: dp(25)
            Deco:
                pos_hint:{"center_x":.5,"center_y":.6}
                md_bg_color: .35, .35, .35, 1
                elevation: 7
                size: app.size_x/1.2, app.size_y/7
                MDLabel:
                    id:test
                    text:"jiji"
                    halign:"center"
                    font_size: "20sp"
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
                    pos_hint:{"center_x":.5,"center_y":.5}

            MDRaisedButton:
                text: "Send"
                pos_hint:{'center_x': .5, 'center_y': .45}
                font_size: "18sp"
                md_bg_color: 36/255, 146/255, 255/255, 1
                on_release:
                    app.send_txt(username.text, test)

    MDScreen:
        name:"availability"
        FloatLayout:
            orientation:'vertical'
            MDLabel:
                bold:True
                text:'Medicine Information'
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.5, 'center_y':.85}
                theme_text_color: "Custom"
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                height: self.texture_size[1]
                width: self.texture_size[1]
            MDLabel:
                text:"Name"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.3, 'center_y':.74}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:"Quantity"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.3, 'center_y':.64}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:"Price"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.3, 'center_y':.54}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:"Expiration Date"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.3, 'center_y':.44}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDSeparator:
                orientation:"vertical"
                pos_hint:{"center_x":.5, "center_y":.6}
                color:80 / 225, 136 / 225, 114 / 225, 1
                width:1
                size_hint:None, .25
            MDLabel:
                text:app.sname
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.7, 'center_y':.74}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                id:quant
                text:app.squantity
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.7, 'center_y':.64}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:app.sprice
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.7, 'center_y':.54}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:app.sexpire
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.7, 'center_y':.44}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4

            NumberOnlyField:
                id:sell_quantity
                mode: "line"
                fill_color: 0, 0, 0, .4
                size_hint: .6, .1
                hint_text:"Quantity:"
                pos_hint:{'center_x':.5, 'center_y':.33}
                text_color: 0, 0, 0, 1
                font_size: dp(18)
                on_text:
                    app.Total(sell_quantity.text)
            MDLabel:
                text:"Total price:"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.3, 'center_y':.22}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:app.total
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.56, 'center_y':.22}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDFillRoundFlatButton:
                text: "Sell"
                size_hint: .4, .06
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                pos_hint:{'center_x':.5, 'center_y':.11}
                md_bg_color:.8, .9, .8, 1
                elevation:5
                on_release:
                    app.sell_product(sell_quantity.text)





    MDScreen:
        name:'sell'
        FloatLayout:
            orientation:'vertical'
            MDLabel:
                bold:True
                text:'Scan Medicine To Sell'
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.5, 'center_y':.85}
                theme_text_color: "Custom"
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                height: self.texture_size[1]
                width: self.texture_size[1]
            MDFillRoundFlatButton:
                id:scan
                text: "Scan Medicine"
                size_hint: .4, .06
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                pos_hint:{'center_x':.5, 'center_y':.75}
                md_bg_color:.8, .9, .8, 1
                elevation:5
                on_release:
                    app.screen_capture("camera3")

    MDScreen:
        name:"move"
        FloatLayout:
            orientation:'vertical'
            MDLabel:
                bold:True
                text:'No Product Found '
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.5, 'center_y':.85}
                theme_text_color: "Custom"
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                height: self.texture_size[1]
                width: self.texture_size[1]
            MDLabel:
                text:"Would you like to add it"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.5, 'center_y':.75}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDFillRoundFlatButton:
                text: "Add new medicine"
                size_hint: .4, .06
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                pos_hint:{'center_x':.5, 'center_y':.65}
                md_bg_color:.8, .9, .8, 1
                elevation:5
                on_release:
                    app.screen_capture("add")


    MDScreen:
        name:'add'
        on_enter:
            app.scan_medicine()
        FloatLayout:
            orientation:'vertical'
            MDLabel:
                bold:True
                text:'Fill Medicine Information'
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.5, 'center_y':.85}
                theme_text_color: "Custom"
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                height: self.texture_size[1]
                width: self.texture_size[1]
            MDFillRoundFlatButton:
                id:med
                text: "Scan Medicine"
                size_hint: .4, .06
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                pos_hint:{'center_x':.5, 'center_y':.75}
                md_bg_color:.8, .9, .8, 1
                elevation:9
                on_release:
                    app.screen_capture("camera")
                    med.pos_hint = {'center_x':1.5, 'center_y':.75}
                    bar.pos_hint = {'center_x':.75, 'center_y':.75}
            MDIconButton:
                id:bar
                halign:"center"
                icon:"barcode-scan"
                user_font_size:"35sp"
                pos_hint:{'center_x':1.5, 'center_y':.75}
                on_release:
                    app.screen_capture("camera")
            MDLabel:
                id:product_id
                text:app.data_id
                theme_text_color: "Custom"
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                halign:"center"
                pos_hint:{'center_x':.5, 'center_y':.75}
            MDTextField:
                id:name
                mode: "line"
                fill_color: 0, 0, 0, .4
                size_hint: .6, .1
                pos_hint:{'center_x':.5, 'center_y':.64}
                hint_text:"Name:"
                text_color: 0, 0, 0, 1
                font_size: dp(18)
            NumberOnlyField:
                id:quantity
                mode: "line"
                fill_color: 0, 0, 0, .4
                size_hint: .6, .1
                hint_text:"Quantity:"
                pos_hint:{'center_x':.5, 'center_y':.52}
                text_color: 0, 0, 0, 1
                font_size: dp(18)
            NumberOnlyField:
                id:price
                mode: "line"
                fill_color: 0, 0, 0, .4
                size_hint: .6, .1
                hint_text:"Price:"
                pos_hint:{'center_x':.5, 'center_y':.4}
                text_color: 0, 0, 0, 1
                font_size: dp(18)
            MDRaisedButton:
                id:exp
                text: app.date
                pos_hint:{'center_x':.65, 'center_y':.27}
                md_bg_color: 80/255, 136/255, 114/255, 1
                elevation:9
                on_release:
                    app.show_date_picker()
            MDLabel:
                id:expired
                halign:"center"
                theme_text_color: "Custom"
                text_color: 0, 0, 0, 0.5
                text:"Expiration Date:"
                pos_hint:{'center_x':.34, 'center_y':.27}
            MDFillRoundFlatButton:
                id:additem
                text: "Add Item"
                size_hint: .4, .06
                text_color: 1, 1, 1, 1
                pos_hint:{'center_x':.5, 'center_y':.15}
                md_bg_color:80 / 225, 136 / 225, 114 / 225, 1
                elevation:5
                on_release:
                    app.add_medicine(product_id.text, name.text, quantity.text, price.text, exp.text)


    MDScreen:
        name:"camera"
        on_enter:
            app.on_kv_post()
        on_leave:
            app.stop_camera()
        BoxLayout:
            orientation: "vertical"
            Scan_Analyze:
                aspect_ratio: "16:9"
                extracted_data:app.got_result
                id:preview

            MDLabel:
                id:ti
                size_hint_y: None
                height: "130dp"

    MDScreen:
        name:"camera2"
        on_enter:
            app.on_kv_post2()
        on_leave:
            app.stop_camera2()
        BoxLayout:
            orientation: "vertical"
            Scan_Analyze:
                aspect_ratio: "16:9"
                extracted_data:app.get_result
                id:preview2

            MDLabel:
                id:t2
                size_hint_y: None
                height: "130dp"

    MDScreen:
        name:"camera3"
        on_enter:
            app.on_kv_post3()
        on_leave:
            app.stop_camera3()
        BoxLayout:
            orientation: "vertical"
            Scan_Analyze:
                aspect_ratio: "16:9"
                extracted_data:app.search_result
                id:preview3

            MDLabel:
                id:ti
                size_hint_y: None
                height: "130dp"
    MDScreen:
        name:"result"
        FloatLayout:
            orientation:'vertical'
            MDLabel:
                bold:True
                text:'Medicine Information'
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.5, 'center_y':.85}
                theme_text_color: "Custom"
                text_color: 80 / 225, 136 / 225, 114 / 225, 1
                height: self.texture_size[1]
                width: self.texture_size[1]
            MDLabel:
                text:"Name"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.3, 'center_y':.74}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:"Quantity"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.3, 'center_y':.64}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:"Price"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.3, 'center_y':.54}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:"Expiration Date"
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.3, 'center_y':.44}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDSeparator:
                orientation:"vertical"
                pos_hint:{"center_x":.5, "center_y":.6}
                color:80 / 225, 136 / 225, 114 / 225, 1
                width:1
                size_hint:None, .25
            MDLabel:
                text:app.sname
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.7, 'center_y':.74}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:app.squantity
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.7, 'center_y':.64}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:app.sprice
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.7, 'center_y':.54}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4
            MDLabel:
                text:app.sexpire
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.7, 'center_y':.44}
                height: self.texture_size[1]
                width: self.texture_size[1]
                theme_text_color: "Custom"
                text_color: 0, 0, 0, .4

    MDScreen:
        name:'verify'
        FloatLayout:
            orientation:'vertical'
            MDLabel:
                bold:True
                text:'Enter Verification Code'
                halign:"center"
                font_style:'H6'
                pos_hint:{'center_x':.5, 'center_y':.8}
                theme_text_color: "Custom"
                text_color: 83 / 225, 186 / 225, 115 / 225, 1
                height: self.texture_size[1]
                width: self.texture_size[1]
            NumberOnlyField:
                id:numberv
                mode: "rectangle"
                fill_color: 0, 0, 0, .4
                size_hint: .5, .1
                hint_text:"6 Digit Code:"
                pos_hint:{'center_x':.5, 'center_y':.7}
                text_color: 0, 0, 0, 1
                font_size: dp(25)
            MDFillRoundFlatButton:
                id:ver
                text: "Verify"
                size_hint: .4, .06
                pos_hint:{'center_x':.5, 'center_y':.55}
                md_bg_color: 83 / 225, 186 / 225, 115 / 225, 1
                on_release:
                    app.verify(numberv.text)

    MDScreen:
        name:"info"
        MDBoxLayout:
            orientation:"vertical"
            MDToolbar:
                title: "Quick Info"
                specific_text_color:78/255, 82/255, 84/255, 1
                md_bg_color:1, 1, 1, 1
            MDTabs:
                allow_stretch:False
                background_color:1, 1, 1, 1
                indicator_color:128/255, 0/255, 0/255, .4
                tab_hint_x:True
                text_color_active:78/255, 82/255, 84/255, 1
                text_color_normal:.5, .5, .5, 1

                Tab:
                    title: "Search medicine"
                    FloatLayout:
                        orientation:'vertical'
                        MDLabel:
                            bold:True
                            text:'Search Medicine Information'
                            halign:"center"
                            font_style:'H6'
                            pos_hint:{'center_x':.5, 'center_y':.85}
                            theme_text_color: "Custom"
                            text_color: 80 / 225, 136 / 225, 114 / 225, 1
                            height: self.texture_size[1]
                            width: self.texture_size[1]
                        MDFillRoundFlatButton:
                            id:scan
                            text: "Scan Medicine"
                            size_hint: .4, .06
                            text_color: 80 / 225, 136 / 225, 114 / 225, 1
                            pos_hint:{'center_x':.5, 'center_y':.75}
                            md_bg_color:.8, .9, .8, 1
                            elevation:5
                            on_release:
                                app.screen_capture("camera2")
                                scan.pos_hint = {'center_x':.5, 'center_y':2}
                                code.pos_hint = {'center_x':.75, 'center_y':.75}
                                search.pos_hint = {'center_x':.5, 'center_y':.64}
                        MDIconButton:
                            id:code
                            halign:"center"
                            icon:"barcode-scan"
                            user_font_size:"35sp"
                            pos_hint:{'center_x':.5, 'center_y':2}
                            on_release:
                                app.screen_capture("camera2")
                        MDFillRoundFlatButton:
                            id:search
                            text: "Search"
                            size_hint: .4, .06
                            text_color: 80 / 225, 136 / 225, 114 / 225, 1
                            pos_hint:{'center_x':.5, 'center_y':2}
                            md_bg_color:.8, .9, .8, 1
                            elevation:5
                            on_release:
                                app.search_medicine(app.data_id)
                        MDLabel:
                            text:app.data_id
                            theme_text_color: "Custom"
                            text_color: 80 / 225, 136 / 225, 114 / 225, 1
                            halign:"center"
                            pos_hint:{'center_x':.5, 'center_y':.75}

                Tab:
                    title: "Report"
                    FloatLayout:

                Tab:
                    title: "Transaction History"
                    FloatLayout:



    MDScreen:
        name:"genesis"
        md_bg_color:80 / 225, 136 / 225, 114 / 225, 1
        md_bg_color:100 / 225, 200 / 225, 200 / 225, 1

        MDBoxLayout:
            orientation:'vertical'
            MDLabel:
                text:'Medics inventory'
                halign:'center'
                bold:True
                size_hint:None, None
                font_style:'H2'
                size_hint:1, 5
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
            MDSpinner:
                id:spine
                size_hint: None, None
                size: dp(40), dp(40)
                pos_hint: {'center_x': .5, 'center_y': 1}
                active: True
                color: 1,1,1,1
            MDLabel:
                text:'Welcome!'
                halign:'center'
                bold:True
                size_hint:None, None
                font_style:'H4'
                size_hint:1, 5
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1


<Deco@MDCard>:
    orientation: "vertical"
    md_bg_color: 1, 1, 1, 1
    padding: "10dp"
    #spacing: "5dp"
    border_radius: 3
    border_color_a: .5
    radius: [9]
    size_hint: None, None
    size: app.size_x/1, app.size_y/2.5
    focus_behavior: False
    ripple_behavior: False

<Front@MDBoxLayout>:
    radius:20
    #height:240
    size:app.size_x/3,app.size_y/6
    md_bg_color:80 / 225, 136 / 225, 114 / 225, 1
    adaptive_height:True
    adaptive_width:True
